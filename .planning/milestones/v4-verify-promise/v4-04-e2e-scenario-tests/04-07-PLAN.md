---
phase: 4
plan: 7
name: Quality Gates & Integration Verification
wave: 3
depends_on: [04-01, 04-02, 04-03, 04-04, 04-05, 04-06]
autonomous: true
parallel_safe: true
---

# Phase 4 Plan 07: Quality Gates & Integration Verification

## Objective

Run the complete test suite, verify all quality gates pass, update documentation (ROADMAP progress, STATE.md), and ensure no regressions were introduced by the E2E test suite. This is the final validation plan for Phase 4.

## Context

**Requirements addressed:** VP-007
**Phase goal contribution:** Ensures the entire E2E test suite runs cleanly within the workspace, all quality gates pass, and project state is updated to reflect Phase 4 completion.

## Tasks

### Task 1: Run full workspace test suite

**Files:** none (verification only)

**Action:**
Execute the complete test suite to verify no regressions:

1. Run all workspace tests:
   ```powershell
   cargo test --workspace
   ```
2. Run the new readme_scenarios tests specifically:
   ```powershell
   cargo test --test readme_scenarios -- --nocapture
   ```
3. Verify test count increased (should be ~12-18 new tests from Phase 4)
4. Check for any flaky tests (run twice if needed)

**Verify:**
```powershell
cargo test --workspace 2>&1 | Select-String "test result"
```

**Done when:**
- All workspace tests pass (0 failures)
- New readme_scenarios tests all pass
- No flaky tests detected

---

### Task 2: Run quality gates

**Files:** none (verification only)

**Action:**
Execute all quality gates:

```powershell
cargo fmt --all --check
cargo clippy -- -D warnings
cargo deny check
cargo build --release
```

Fix any issues introduced by the E2E tests:
- Format violations → `cargo fmt --all`
- Clippy warnings → Fix in test files
- Deny issues → Update deny.toml if false positive

**Verify:**
```powershell
.\scripts\local-ci.ps1
```

**Done when:**
- `cargo fmt --all --check` exits 0
- `cargo clippy -- -D warnings` exits 0 (no warnings)
- `cargo deny check` exits 0 (no advisories)
- `cargo build --release` exits 0

---

### Task 3: Update project state and documentation

**Files:** `.planning/STATE.md`, `.planning/milestones/v4-verify-promise/ROADMAP.md`

**Action:**

1. Update `STATE.md`:
   - Phase 4 status: ✅ Done
   - Phase 5 status: ⬜ Ready to plan
   - Update test count
   - Record completion date

2. Update `ROADMAP.md` progress:
   - Phase 4 progress bar: `██████████ 100%`
   - Check off all Phase 4 success criteria checkboxes
   - Update "Last updated" line

3. Create test coverage summary:
   - List all scenarios tested with pass/fail status
   - Note any scenarios that required simplification (e.g., subquery limitations)
   - Document any "Coming Soon" features discovered during testing

**Verify:**
```powershell
Get-Content .planning\STATE.md | Select-String "Phase 4"
```

**Done when:**
- STATE.md reflects Phase 4 complete
- ROADMAP.md progress updated
- All scenario test statuses documented

---

## Verification

After all tasks complete:

```powershell
cargo test --workspace
.\scripts\local-ci.ps1
```

## Success Criteria

- [ ] All workspace tests pass (0 failures)
- [ ] All quality gates pass (fmt, clippy, deny, release build)
- [ ] STATE.md updated: Phase 4 ✅ Done, Phase 5 ready to plan
- [ ] ROADMAP.md Phase 4 progress = 100%
- [ ] No regressions in existing test suite
- [ ] Test count increased by ~12-18 new E2E tests

## Parallel Safety

**Exclusive write files:** `.planning/STATE.md`, `.planning/milestones/v4-verify-promise/ROADMAP.md`
**Shared read files:** all test files (read), `crates/velesdb-core/src/**` (read)
**Conflicts with:** none (Wave 3 — runs alone after all Wave 2 plans)

## Output

**Files modified:**
- `.planning/STATE.md` — Phase 4 completion status
- `.planning/milestones/v4-verify-promise/ROADMAP.md` — Progress update
