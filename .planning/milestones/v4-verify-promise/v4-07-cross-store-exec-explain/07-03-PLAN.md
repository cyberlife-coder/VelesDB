# Plan 07-03: Integration & Quality Gates

## Objective

Validate all Phase 7 deliverables with E2E integration tests and full quality gate suite.

**Estimate:** 2-3h
**Wave:** 1 (after 07-01 and 07-02)

---

## Tasks

### Task 1: E2E integration tests for cross-store execution

**Files:** `crates/velesdb-core/tests/phase7_integration.rs`

**Action:**
1. Create E2E test file with:
   - `e2e_cross_store_vector_first_with_graph` — full flow: insert data with graph edges, query NEAR + MATCH, verify VectorFirst strategy returns graph-validated results
   - `e2e_cross_store_parallel_with_graph` — full flow with Parallel strategy + RRF fusion
   - `e2e_cross_store_with_metadata_filter` — three-way: V + G + metadata filter
   - `e2e_explain_near_fused_via_parser` — parse NEAR_FUSED query → EXPLAIN → verify FusedSearch node
   - `e2e_explain_cross_store_via_parser` — parse combined V+G query → EXPLAIN → verify CrossStoreSearch node
   - `e2e_cross_store_no_regression_pure_near` — pure NEAR queries unchanged
   - `e2e_cross_store_no_regression_pure_match` — pure MATCH queries unchanged
2. Use realistic data: documents with vectors, payloads, and graph edges

**Verify:** `cargo test --test phase7_integration`

**Done:** All E2E tests pass

### Task 2: Run full quality gates

**Action:**
1. Run complete validation suite:
   ```powershell
   cargo fmt --all --check
   cargo clippy -- -D warnings
   cargo deny check
   cargo test --workspace
   cargo build --release --package velesdb-core --package velesdb-server --package velesdb-wasm --package velesdb-cli
   ```
2. Verify no regressions on existing ~3,234 tests
3. Verify new test count (15+ new tests from Phase 7)

**Verify:** All gates green

**Done:** Quality gates pass

### Task 3: Update documentation

**Files:** `.planning/STATE.md`

**Action:**
1. Update STATE.md to reflect Phase 7 completion
2. Mark VP-010 as fully resolved (no more deferred items)
3. Update test count
4. Commit with descriptive message

**Done:** STATE.md updated, committed

---

## Success Criteria

- [ ] 7+ E2E integration tests pass
- [ ] All ~3,250+ workspace tests pass
- [ ] `cargo fmt --all --check` ✅
- [ ] `cargo clippy -- -D warnings` ✅
- [ ] `cargo deny check` ✅
- [ ] `cargo build --release` ✅ (core, server, wasm, cli)
- [ ] STATE.md updated with Phase 7 status
